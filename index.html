<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>80 Tahun Kemerdekaan RI, AR Selfie Frame (iOS Fixed)</title>
  <style>
    /* layout */
    html, body { height:100%; margin:0; background:#000; font-family:system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans', 'Helvetica Neue', Arial; color:#fff; }
    #app { position:relative; width:100%; height:100vh; overflow:hidden; }

    video#camera { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; background:#111; }

    .overlay-wrap { position:absolute; inset:0; pointer-events:none; display:flex; align-items:center; justify-content:center; }
    svg.overlay { width:100%; height:100%; }

    .center-cta { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); display:flex; flex-direction:column; gap:12px; align-items:center; z-index:40; }
    .cta-btn { background:#e21b2d; color:white; border:none; padding:14px 20px; border-radius:12px; font-size:18px; box-shadow:0 8px 24px rgba(0,0,0,0.4); display:flex; align-items:center; gap: 8px; }
    .cta-secondary { background:rgba(255,255,255,0.08); padding:10px 14px; border-radius:10px; }

    .ui { position:absolute; left:0; right:0; bottom: 150px; /* Moved up */ display:flex; gap:12px; justify-content:center; pointer-events:auto; z-index:30; }
    button { background:#e21b2d; color:white; border:none; padding:12px 16px; border-radius:10px; font-size:16px; box-shadow:0 6px 18px rgba(0,0,0,0.25); display:flex; align-items:center; gap: 8px; }
    button.secondary { background:rgba(255,255,255,0.12); }

    .topbar { position:absolute; left:12px; top:12px; display:flex; gap:8px; pointer-events:auto; z-index:30; }
    .chip { background:rgba(0,0,0,0.45); color:white; padding:8px 10px; border-radius:999px; font-size:14px; }

    .caption { position:absolute; left:12px; bottom: 220px; /* Moved up */ color:white; font-size:13px; text-shadow:0 2px 6px rgba(0,0,0,0.6); z-index:30; }

    .message { position:absolute; right:12px; top:12px; max-width:320px; background:rgba(0,0,0,0.55); padding:12px; border-radius:10px; font-size:13px; z-index:35; }

    input[type=file] { display:none; }

    .sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }
    .warning { background:#ffcdd2; color:#000; padding:10px; border-radius:8px; font-size:13px; }

    /* Styles for iOS image preview */
    #previewOverlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 999;
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        padding: 20px; box-sizing: border-box;
    }
    #previewOverlay img { max-width: 100%; max-height: 75%; border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    #previewOverlay .instruction { color: white; font-size: 16px; text-align: center; margin-top: 20px; }
    #previewOverlay .close-btn { margin-top: 20px; background: #555; }
  </style>
</head>
<body>

  <div id="app">
    <video id="camera" autoplay playsinline muted></video>
    <div class="overlay-wrap" aria-hidden="true"><svg class="overlay" viewBox="0 0 360 780" preserveAspectRatio="xMidYMid slice" xmlns="http://www.w3.org/2000/svg"><defs><mask id="center-hole"><rect x="0" y="0" width="100%" height="100%" fill="white" /><rect x="36" y="140" width="288" height="360" rx="18" ry="18" fill="black" /></mask></defs><g mask="url(#center-hole)"><rect x="0" y="0" width="100%" height="120" fill="#e21b2d" /><text x="50%" y="64" text-anchor="middle" alignment-baseline="middle" font-size="22" font-weight="700" fill="#fff">80 Tahun Kemerdekaan RI</text><text x="50%" y="92" text-anchor="middle" alignment-baseline="middle" font-size="12" fill="#fff">Dirgahayu Republik Indonesia</text><g transform="translate(12,12) scale(0.9)"><circle cx="20" cy="20" r="16" fill="#ffd54a" /><path d="M20 10 L25 20 L20 30 L15 20 Z" fill="#e21b2d" /></g><path d="M320 24 q12 10 0 24 q-12 14 -24 0 q-12 -14 0 -24 q12 -10 24 0" fill="#fff" opacity="0.95" /><path d="M320 26 q10 8 0 20 q-10 12 -20 0 q-10 -12 0 -20 q10 -8 20 0" fill="#e21b2d" /></g><g mask="url(#center-hole)"><rect x="0" y="660" width="100%" height="120" fill="#e21b2d" /><text x="50%" y="704" text-anchor="middle" alignment-baseline="middle" font-size="16" font-weight="600" fill="#fff">17 Agustus 1945, 80 Tahun</text></g><g mask="url(#center-hole)"><circle cx="40" cy="360" r="8" fill="#ffd54a" /><circle cx="320" cy="360" r="8" fill="#ffd54a" /></g></svg></div>
    <div class="center-cta" id="startPanel"><div class="warning" id="contextWarning" style="display:none">Note, camera access requires https, or localhost. If you open this as a file, the camera may be blocked.</div><button class="cta-btn" id="startBtn">ðŸ“¹ Mulai Kamera</button><label class="cta-secondary" for="fileInput">atau unggah foto</label><input id="fileInput" type="file" accept="image/*" capture="environment" /></div>
    <div class="topbar"><div class="chip" id="flipLabel">kamera belum aktif</div></div>
    <div class="message" id="msgBox" style="display:none"></div>
    <div class="caption">Pusat foto tetap transparan, foto bisa diambil atau dibagikan</div>
    <div class="ui"><button id="switchBtn" class="secondary" title="Ganti kamera">ðŸ”„ Ganti Kamera</button><button id="captureBtn">ðŸ“· Ambil Foto</button><button id="shareBtn" class="secondary">ðŸ“¤ Bagikan</button></div>
    <a class="sr-only" id="downloadLink">download</a>
  </div>